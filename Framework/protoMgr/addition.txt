import idMgr "work.goproject.com/Framework/idMgr"
import time "time"


func (m *TraceItem) SetEndTime(endTime int64) {
	m.EndTime = endTime
	m.UseTime = (m.EndTime - m.StartTime) / 1000 / 1000
}

func NewTraceItem(name string, startTime int64) *TraceItem {
	return &TraceItem{
		Name:      name,
		StartTime: startTime,
		EndTime:   startTime,
		UseTime:   0,
	}
}


func (m *TraceObject) String() string {
	for _, item := range m.TraceItems {
		item.StartTime = 0
		item.EndTime = 0
	}
	return proto.CompactTextString(m)
}


func (m *TraceObject) AddTraceItem(item *TraceItem) {
	m.TraceItems = append(m.TraceItems, item)
}

func NewTraceObject(extendInfo string) *TraceObject {
	id, err := idMgr.GenerateNewId(int64(1))
	if err != nil {
		id = time.Now().UnixNano()
	}

	return &TraceObject{
		Id:         id,
		ExtendInfo: extendInfo,
		TraceItems: make([]*TraceItem, 0, 4),
	}
}